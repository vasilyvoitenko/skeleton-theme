<div class="custom-section full-width">
  {% if section.settings.background_image %}
    <div class="custom-section__background">
      {{ section.settings.background_image | image_url: width: 2000 | image_tag }}
    </div>
  {% endif %}

  {% assign block_count = section.blocks.size %}
  <div class="custom-section__content{% if block_count == 2 %} custom-section__content--flex{% endif %}">
    {% for block in section.blocks %}
      <div class="custom-section__block">
        {% render block %}
      </div>
    {% endfor %}
  </div>
</div>

{% stylesheet %}
  .custom-section {
    position: relative;
    overflow: hidden;
    width: 100%;
  }
  .custom-section__background {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
  }
  .custom-section__background img {
    position: absolute;
    width: 100%;
    height: auto;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  .custom-section__content {
    display: grid;
    grid-template-columns: var(--content-grid);
    padding-left: 24px;
    padding-right: 24px;
  }
  .custom-section__content > * {
    grid-column: 2;
    margin-left: 0;
    margin-right: 0;
    width: 100%;
    box-sizing: border-box;
  }
  .custom-section__content--flex {
    display: flex !important;
    flex-direction: row;
    gap: 32px;
    justify-content: flex-start;
    align-items: flex-start;
    padding-left: 24px;
    padding-right: 24px;
  }
  .custom-section__content--flex > .custom-section__block {
    flex: 1 1 0;
    min-width: 320px;
    max-width: 100%;
    box-sizing: border-box;
  }
  @media (max-width: 900px) {
    .custom-section__content--flex {
      flex-direction: column;
      gap: 24px;
      padding-left: 12px;
      padding-right: 12px;
    }
    .custom-section__content--flex > .custom-section__block {
      min-width: 0;
    }
    .custom-section__content {
      padding-left: 12px;
      padding-right: 12px;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.custom_section",
  "blocks": [{ "type": "@theme" }],
  "settings": [
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "t:labels.background"
    }
  ],
  "presets": [
    {
      "name": "t:general.custom_section"
    }
  ]
}
{% endschema %}
